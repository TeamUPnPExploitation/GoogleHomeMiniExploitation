from urllib.request import urlopen
from urllib.parse import urlparse
from xml.dom import minidom

# Return text contents of XML node.
def XMLGetText(node):
	text = []
	for childNode in node.childNodes:
		if childNode.nodeType == node.TEXT_NODE:
			text.append(childNode.data)
	return(''.join(text))

location = 'http://192.168.178.1:5000/rootDesc.xml'

# Get SCPD
response = urlopen(location)
root_xml = minidom.parseString(response.read())
response.close()

# Get BaseURL
base_url_elem = root_xml.getElementsByTagName('URLBase')
if base_url_elem:
	base_url = XMLGetText(base_url_elem[0]).rstrip('/')
else:
	url = urlparse(location)
	base_url = '%s://%s' % (url.scheme, url.netloc)

#Output:
for node in root_xml.getElementsByTagName('service'):
	service_type = XMLGetText(node.getElementsByTagName('serviceType')[0])
	control_url = '%s%s' % (base_url, XMLGetText(node.getElementsByTagName('controlURL')[0]))

	scpd_url = '%s%s' % (base_url, XMLGetText(node.getElementsByTagName('SCPDURL')[0]))

	print('%s:\n SCPD_URL: %s\n CTRL_URL: %s\n' % (service_type, scpd_url, control_url))

	



	

